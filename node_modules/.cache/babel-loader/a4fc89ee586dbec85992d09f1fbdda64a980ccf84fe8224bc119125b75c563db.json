{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import{addFav,removeFav,getAllFavorites,validateAccessToken}from\"../app.js\";import cookie from\"js-cookie\";import\"./Info.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Info=_ref=>{let{itemID,price,title,user}=_ref;const navigate=useNavigate();const[isFavorite,setIsFavorite]=useState(false);const[isLoggedIn,setIsLoggedIn]=useState(false);const[isLoading,setIsLoading]=useState(true);const formattedPrice=parseFloat(price).toFixed(2);useEffect(()=>{const checkAuthentication=async()=>{const accessToken=cookie.get(\"accessToken\");if(accessToken){try{const isAuthenticated=await validateAccessToken();setIsLoggedIn(isAuthenticated);}catch(error){console.error(\"Error checking validity in Info.jsx:\",error);}}};checkAuthentication();},[]);useEffect(()=>{const checkFavorites=async()=>{setIsLoading(true);if(isLoggedIn){try{const favArray=await getAllFavorites();if(favArray&&Array.isArray(favArray)){const isFav=favArray.some(fav=>fav.ItemID===itemID);setIsFavorite(isFav);}}catch(error){console.error(\"Error checking favorites in Info.jsx:\",error);}}setIsLoading(false);};checkFavorites();},[isLoggedIn,itemID]);const handleFavClick=async()=>{if(!isLoggedIn){alert(\"You need to be logged in to add to favorites\");navigate(\"/login\");return;}else{try{if(isFavorite){await removeFav(itemID);setIsFavorite(false);}else{await addFav(itemID);setIsFavorite(true);}}catch(error){console.error(\"Error handling favorites in Info.jsx:\",error);}}};return/*#__PURE__*/_jsxs(\"div\",{id:\"info\",children:[/*#__PURE__*/_jsx(\"h3\",{children:title}),/*#__PURE__*/_jsxs(\"p\",{children:[formattedPrice,\" $\"]}),/*#__PURE__*/_jsxs(\"div\",{id:\"buttList\",children:[/*#__PURE__*/_jsx(\"button\",{id:\"message\",className:\"buttons\",onClick:isLoggedIn?()=>navigate(\"/chat/\".concat(user)):()=>navigate(\"/login\"),children:\"Message\"}),/*#__PURE__*/_jsx(\"button\",{id:\"fav\",className:\"buttons\",onClick:handleFavClick,children:isLoading?\"Loading...\":isFavorite?\"Remove from favorites\":\"Add to favorites\"})]})]});};export default Info;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","addFav","removeFav","getAllFavorites","validateAccessToken","cookie","jsx","_jsx","jsxs","_jsxs","Info","_ref","itemID","price","title","user","navigate","isFavorite","setIsFavorite","isLoggedIn","setIsLoggedIn","isLoading","setIsLoading","formattedPrice","parseFloat","toFixed","checkAuthentication","accessToken","get","isAuthenticated","error","console","checkFavorites","favArray","Array","isArray","isFav","some","fav","ItemID","handleFavClick","alert","id","children","className","onClick","concat"],"sources":["C:/Users/Bodnarchuk Bohdan/Desktop/bazar_remake/frontend/src/components/Info.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport {\r\n  addFav,\r\n  removeFav,\r\n  getAllFavorites,\r\n  validateAccessToken,\r\n} from \"../app.js\";\r\nimport cookie from \"js-cookie\";\r\nimport \"./Info.css\";\r\n\r\nconst Info = ({ itemID, price, title, user }) => {\r\n  const navigate = useNavigate();\r\n  const [isFavorite, setIsFavorite] = useState(false);\r\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const formattedPrice = parseFloat(price).toFixed(2);\r\n\r\n  useEffect(() => {\r\n    const checkAuthentication = async () => {\r\n      const accessToken = cookie.get(\"accessToken\");\r\n      if (accessToken) {\r\n        try {\r\n          const isAuthenticated = await validateAccessToken();\r\n          setIsLoggedIn(isAuthenticated);\r\n        } catch (error) {\r\n          console.error(\"Error checking validity in Info.jsx:\", error);\r\n        }\r\n      }\r\n    };\r\n    checkAuthentication();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const checkFavorites = async () => {\r\n      setIsLoading(true);\r\n      if (isLoggedIn) {\r\n        try {\r\n          const favArray = await getAllFavorites();\r\n          if (favArray && Array.isArray(favArray)) {\r\n            const isFav = favArray.some((fav) => fav.ItemID === itemID);\r\n            setIsFavorite(isFav);\r\n          }\r\n        } catch (error) {\r\n          console.error(\"Error checking favorites in Info.jsx:\", error);\r\n        }\r\n      }\r\n      setIsLoading(false);\r\n    };\r\n    checkFavorites();\r\n  }, [isLoggedIn, itemID]);\r\n\r\n  const handleFavClick = async () => {\r\n    if (!isLoggedIn) {\r\n      alert(\"You need to be logged in to add to favorites\");\r\n      navigate(\"/login\");\r\n      return;\r\n    } else {\r\n      try {\r\n        if (isFavorite) {\r\n          await removeFav(itemID);\r\n          setIsFavorite(false);\r\n        } else {\r\n          await addFav(itemID);\r\n          setIsFavorite(true);\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error handling favorites in Info.jsx:\", error);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div id=\"info\">\r\n      <h3>{title}</h3>\r\n      <p>{formattedPrice} $</p>\r\n      <div id=\"buttList\">\r\n        <button\r\n          id=\"message\"\r\n          className=\"buttons\"\r\n          onClick={\r\n            isLoggedIn\r\n              ? () => navigate(`/chat/${user}`)\r\n              : () => navigate(\"/login\")\r\n          }\r\n        >\r\n          Message\r\n        </button>\r\n        <button id=\"fav\" className=\"buttons\" onClick={handleFavClick}>\r\n          {isLoading\r\n            ? \"Loading...\"\r\n            : isFavorite\r\n            ? \"Remove from favorites\"\r\n            : \"Add to favorites\"}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Info;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}