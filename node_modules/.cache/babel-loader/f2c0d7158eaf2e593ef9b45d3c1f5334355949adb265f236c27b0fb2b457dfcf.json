{"ast":null,"code":"//app.js\nimport cookie from\"js-cookie\";const config=require(\"./configs/config.js\");export async function insertUser(){var firstName=document.getElementById(\"fname\").value;var lastName=document.getElementById(\"lname\").value;var username=document.getElementById(\"username\").value;var email=document.getElementById(\"email\").value;var password=document.getElementById(\"pass\").value;try{const response=await fetch(\"http://\".concat(config.host,\"/api/insertUser\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({firstName:firstName,lastName:lastName,username:username,email:email,password:password})});if(!response.ok){throw new Error(\"Failed to insert user\");}else{alert(\"User added successfully\");}}catch(err){console.error(\"Error:\",err);alert(\"Error adding user\");}}export async function addFav(productID){let user=await getCurrentUser();let userID=user.id;try{const response=await fetch(\"http://\".concat(config.host,\":3001/api/addFav\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({userID:userID,productID:productID})});if(response.ok){alert(\"Favorite added successfully\");}else{throw new Error(\"Failed to add favorite\");}}catch(err){console.error(\"Error:\",err);alert(\"Error adding favorite\");}}export async function removeFav(productID){var userID=getCurrentUser().id;try{const response=await fetch(\"http://\".concat(config.host,\":3001/api/removeFav\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({userID:userID,productID:productID})});if(response.ok){alert(\"Favorite removed successfully\");}else{throw new Error(\"Failed to remove favorite\");}}catch(err){console.error(\"Error:\",err);alert(\"Error removing favorite\");}}export async function getAllFavorites(){var user=await getCurrentUser();try{const response=await fetch(\"http://\".concat(config.host,\":3001/api/getAllFavorites\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({userID:user.id})});if(response.ok){const data=await response.json();return Array.isArray(data)?data:[data];}else{throw new Error(\"Failed to fetch favorites\");}}catch(err){console.error(\"Error:\",err);alert(\"Error fetching favorites\");}}export async function login(){var username=document.getElementById(\"username\").value;var password=document.getElementById(\"pass\").value;try{const response=await fetch(\"http://\".concat(config.host,\":3001/api/login\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({username:username,password:password})});if(response.ok){const data=await response.json();// Save access token in cookie\ndocument.cookie=\"accessToken=\".concat(data.accessToken);alert(\"Login successful\");window.location.replace(\"/\");}else if(response.status===404){alert(\"User not found\");}else if(response.status===401){alert(\"Incorrect password\");}else{throw new Error(\"Failed to login\");}}catch(err){console.error(\"Error:\",err);alert(\"Error logging in\");}}export async function validateAccessToken(){var accessToken=cookie.get(\"accessToken\");try{const response=await fetch(\"http://\".concat(config.host,\":3001/api/validateAccessToken\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({accessToken:accessToken})});if(response.ok){return true;}else if(response.status===401){cookie.remove(\"accessToken\");return false;}else{cookie.remove(\"accessToken\");throw new Error(\"Failed to validate access token\");}}catch(err){console.error(\"Error:\",err);alert(\"Error validating access token\");return false;}}export const getCurrentUser=async()=>{try{const accessToken=cookie.get(\"accessToken\");const response=await fetch(\"http://\".concat(config.host,\":3001/api/getCurrentUser\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({accessToken})});if(!response.ok){throw new Error(\"Failed to fetch current user data\");}const userData=await response.json();return userData;}catch(error){console.error(\"Error fetching current user:\",error.message);throw error;}};/* \r\nexport async function getAllItems() {\r\n  try {\r\n    const response = await fetch(`http://${config.url}:3001/api/getAllItems`, {\r\n      method: \"GET\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    });\r\n\r\n    return response.json();\r\n  } catch (err) {\r\n    console.error(\"Error:\", err);\r\n  }\r\n} */","map":{"version":3,"names":["cookie","config","require","insertUser","firstName","document","getElementById","value","lastName","username","email","password","response","fetch","concat","host","method","headers","body","JSON","stringify","ok","Error","alert","err","console","error","addFav","productID","user","getCurrentUser","userID","id","removeFav","getAllFavorites","data","json","Array","isArray","login","accessToken","window","location","replace","status","validateAccessToken","get","remove","userData","message"],"sources":["C:/Users/Bodnarchuk Bohdan/Desktop/bazar_remake/frontend/src/app.js"],"sourcesContent":["//app.js\r\nimport cookie from \"js-cookie\";\r\nconst config = require(\"./configs/config.js\");\r\n\r\nexport async function insertUser() {\r\n  var firstName = document.getElementById(\"fname\").value;\r\n  var lastName = document.getElementById(\"lname\").value;\r\n  var username = document.getElementById(\"username\").value;\r\n  var email = document.getElementById(\"email\").value;\r\n  var password = document.getElementById(\"pass\").value;\r\n\r\n  try {\r\n    const response = await fetch(`http://${config.host}/api/insertUser`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        firstName: firstName,\r\n        lastName: lastName,\r\n        username: username,\r\n        email: email,\r\n        password: password,\r\n      }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(\"Failed to insert user\");\r\n    } else {\r\n      alert(\"User added successfully\");\r\n    }\r\n  } catch (err) {\r\n    console.error(\"Error:\", err);\r\n    alert(\"Error adding user\");\r\n  }\r\n}\r\n\r\nexport async function addFav(productID) {\r\n  let user = await getCurrentUser();\r\n  let userID = user.id;\r\n\r\n  try {\r\n    const response = await fetch(`http://${config.host}:3001/api/addFav`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        userID: userID,\r\n        productID: productID,\r\n      }),\r\n    });\r\n\r\n    if (response.ok) {\r\n      alert(\"Favorite added successfully\");\r\n    } else {\r\n      throw new Error(\"Failed to add favorite\");\r\n    }\r\n  } catch (err) {\r\n    console.error(\"Error:\", err);\r\n    alert(\"Error adding favorite\");\r\n  }\r\n}\r\nexport async function removeFav(productID) {\r\n  var userID = getCurrentUser().id;\r\n\r\n  try {\r\n    const response = await fetch(`http://${config.host}:3001/api/removeFav`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        userID: userID,\r\n        productID: productID,\r\n      }),\r\n    });\r\n\r\n    if (response.ok) {\r\n      alert(\"Favorite removed successfully\");\r\n    } else {\r\n      throw new Error(\"Failed to remove favorite\");\r\n    }\r\n  } catch (err) {\r\n    console.error(\"Error:\", err);\r\n    alert(\"Error removing favorite\");\r\n  }\r\n}\r\nexport async function getAllFavorites() {\r\n  var user = await getCurrentUser();\r\n  try {\r\n    const response = await fetch(\r\n      `http://${config.host}:3001/api/getAllFavorites`,\r\n      {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          userID: user.id,\r\n        }),\r\n      }\r\n    );\r\n    if (response.ok) {\r\n      const data = await response.json();\r\n      return Array.isArray(data) ? data : [data];\r\n    } else {\r\n      throw new Error(\"Failed to fetch favorites\");\r\n    }\r\n  } catch (err) {\r\n    console.error(\"Error:\", err);\r\n    alert(\"Error fetching favorites\");\r\n  }\r\n}\r\n\r\nexport async function login() {\r\n  var username = document.getElementById(\"username\").value;\r\n  var password = document.getElementById(\"pass\").value;\r\n\r\n  try {\r\n    const response = await fetch(`http://${config.host}:3001/api/login`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        username: username,\r\n        password: password,\r\n      }),\r\n    });\r\n\r\n    if (response.ok) {\r\n      const data = await response.json();\r\n      // Save access token in cookie\r\n      document.cookie = `accessToken=${data.accessToken}`;\r\n      alert(\"Login successful\");\r\n      window.location.replace(\"/\");\r\n    } else if (response.status === 404) {\r\n      alert(\"User not found\");\r\n    } else if (response.status === 401) {\r\n      alert(\"Incorrect password\");\r\n    } else {\r\n      throw new Error(\"Failed to login\");\r\n    }\r\n  } catch (err) {\r\n    console.error(\"Error:\", err);\r\n    alert(\"Error logging in\");\r\n  }\r\n}\r\nexport async function validateAccessToken() {\r\n  var accessToken = cookie.get(\"accessToken\");\r\n\r\n  try {\r\n    const response = await fetch(\r\n      `http://${config.host}:3001/api/validateAccessToken`,\r\n      {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          accessToken: accessToken,\r\n        }),\r\n      }\r\n    );\r\n\r\n    if (response.ok) {\r\n      return true;\r\n    } else if (response.status === 401) {\r\n      cookie.remove(\"accessToken\");\r\n      return false;\r\n    } else {\r\n      cookie.remove(\"accessToken\");\r\n      throw new Error(\"Failed to validate access token\");\r\n    }\r\n  } catch (err) {\r\n    console.error(\"Error:\", err);\r\n    alert(\"Error validating access token\");\r\n    return false;\r\n  }\r\n}\r\nexport const getCurrentUser = async () => {\r\n  try {\r\n    const accessToken = cookie.get(\"accessToken\");\r\n    const response = await fetch(\r\n      `http://${config.host}:3001/api/getCurrentUser`,\r\n      {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ accessToken }),\r\n      }\r\n    );\r\n\r\n    if (!response.ok) {\r\n      throw new Error(\"Failed to fetch current user data\");\r\n    }\r\n\r\n    const userData = await response.json();\r\n    return userData;\r\n  } catch (error) {\r\n    console.error(\"Error fetching current user:\", error.message);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/* \r\nexport async function getAllItems() {\r\n  try {\r\n    const response = await fetch(`http://${config.url}:3001/api/getAllItems`, {\r\n      method: \"GET\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    });\r\n\r\n    return response.json();\r\n  } catch (err) {\r\n    console.error(\"Error:\", err);\r\n  }\r\n} */\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}